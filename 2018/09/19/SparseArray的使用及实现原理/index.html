<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>SparseArray的使用及实现原理 | Xlee</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="SparseArray的使用及实现原理">
<meta name="keywords" content="SparseArray">
<meta property="og:type" content="article">
<meta property="og:title" content="SparseArray的使用及实现原理">
<meta property="og:url" content="https//xlee00.github.io/2018/09/19/SparseArray的使用及实现原理/index.html">
<meta property="og:site_name" content="Xlee">
<meta property="og:description" content="SparseArray的使用及实现原理">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="/2018/09/19/SparseArray的使用及实现原理/sparse_array_put_one.jpg">
<meta property="og:image" content="/2018/09/19/SparseArray的使用及实现原理/sparse_array_put_two.jpg">
<meta property="og:image" content="/2018/09/19/SparseArray的使用及实现原理/sparse_array_put_three.jpg">
<meta property="og:image" content="/2018/09/19/SparseArray的使用及实现原理/sparse_array_put_four.jpg">
<meta property="og:image" content="/2018/09/19/SparseArray的使用及实现原理/sparse_array_remove.png">
<meta property="og:image" content="/2018/09/19/SparseArray的使用及实现原理/sparse_array_gc.png">
<meta property="og:updated_time" content="2019-07-29T08:36:56.666Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SparseArray的使用及实现原理">
<meta name="twitter:description" content="SparseArray的使用及实现原理">
<meta name="twitter:image" content="/2018/09/19/SparseArray的使用及实现原理/sparse_array_put_one.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Xlee" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Xlee</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">与世界分享你的知识、经验和见解</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https//xlee00.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-SparseArray的使用及实现原理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/19/SparseArray的使用及实现原理/" class="article-date">
  <time datetime="2018-09-19T12:04:59.000Z" itemprop="datePublished">2018-09-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/科技/">科技</a>►<a class="article-category-link" href="/categories/科技/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      SparseArray的使用及实现原理
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>SparseArray的使用及实现原理</p>
<a id="more"></a>
<h2 id="SparseArray-的使用"><a href="#SparseArray-的使用" class="headerlink" title="SparseArray 的使用"></a>SparseArray 的使用</h2><h3 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SparseArray&lt;Student&gt; sparseArray = <span class="keyword">new</span> SparseArray&lt;&gt;();</span><br><span class="line">SparseArray&lt;Student&gt; sparseArray = <span class="keyword">new</span> SparseArray&lt;&gt;(capacity);</span><br></pre></td></tr></table></figure>

<p>首先来看看如何创建一个SparseArray，前文说了SparseArray是用来替换HashMap的，而SparseArray只需要指定一个泛型，似乎说明key的类型在SparseArray内部已经指定了呢？<br>SparseArray有两个构造方法，一个默认构造方法，一个传入容量。</p>
<h3 id="put"><a href="#put" class="headerlink" title="put()"></a>put()</h3><p>创建完sparseArray后，来看看怎么往里面存放数据吧。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sparseArray.put(<span class="keyword">int</span> key,Student value);</span><br></pre></td></tr></table></figure>

<h3 id="get"><a href="#get" class="headerlink" title="get()"></a>get()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sparseArray.get(<span class="keyword">int</span> key);</span><br><span class="line">sparseArray.get(<span class="keyword">int</span> key,Student valueIfNotFound)</span><br></pre></td></tr></table></figure>

<h3 id="remove"><a href="#remove" class="headerlink" title="remove()"></a>remove()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sparseArray.remove(<span class="keyword">int</span> key);</span><br></pre></td></tr></table></figure>

<h3 id="index"><a href="#index" class="headerlink" title="index"></a>index</h3><p>前面几个都跟HashMap没有什么太大区别，而这个index就是SparseArray所特有的属性了，这里为了方便理解先提一嘴，SparseArray从名字上看就能猜到跟数组有关系，事实上他底层是两条数组，一组存放key，一组存放value，知道了这一点应该能猜到index的作用了。</p>
<p>index — key在数组中的位置。SparseArray提供了一些跟index相关的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sparseArray.indexOfKey(<span class="keyword">int</span> key);</span><br><span class="line">sparseArray.indexOfValue(T value);</span><br><span class="line">sparseArray.keyAt(<span class="keyword">int</span> index);</span><br><span class="line">sparseArray.valueAt(<span class="keyword">int</span> index);</span><br><span class="line">sparseArray.setValueAt(<span class="keyword">int</span> index);</span><br><span class="line">sparseArray.removeAt(<span class="keyword">int</span> index);</span><br><span class="line">sparseArray.removeAt(<span class="keyword">int</span> index,<span class="keyword">int</span> size);</span><br></pre></td></tr></table></figure>

<h2 id="SparseArray-实现原理"><a href="#SparseArray-实现原理" class="headerlink" title="SparseArray 实现原理"></a>SparseArray 实现原理</h2><p>前面简单的介绍了 SparseArray 的使用，为了在实际工作中最合理的选用数据结构，深入的了解每种数据结构的实现原理是很有必要的，这样可以更好的理解和比较不同数据结构之间的优缺点，比死记概念要更好，甚至可以根据自己的具体需求去实现最适合需求的数据结构。</p>
<p>话不多说，打开源码来一探究竟。我看源码的习惯，是先看这个类文件的注释，一般能在整体上给个思路。</p>
<blockquote>
<p>SparseArrays map integers to Objects. Unlike a normal array of Objects,there can be gaps in the indices. It is intended to be more memory efficient than using a HashMap to map Integers to Objects, both because it avoids auto-boxing keys and its data structure doesn’t rely on an extra entry object for each mapping.</p>
</blockquote>
<p>这段注释基本解释了该类的作用：使用int[]数组存放key，避免了HashMap中基本数据类型需要装箱的步骤，其次不使用额外的结构体（Entry)，单个元素的存储成本下降。</p>
<p>如果你对装箱的概念还不清楚，可以看看小黑屋的这篇文章：<a href="http://droidyue.com/blog/2015/04/07/autoboxing-and-autounboxing-in-java/" target="_blank" rel="noopener">Java中的自动装箱与拆箱</a>。</p>
<h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p>SparseArray没有继承任何其他的数据结构，实现了Cloneable接口。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">private</span> <span class="keyword">int</span>[] mKeys;</span><br><span class="line"> <span class="keyword">private</span> Object[] mValues;</span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">int</span> mSize; <span class="comment">//当前实际存放的数量</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * Creates a new SparseArray containing no mappings.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">SparseArrayCompat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     <span class="keyword">this</span>(<span class="number">10</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * Creates a new SparseArray containing no mappings that will not</span></span><br><span class="line"><span class="comment">  * require any additional memory allocation to store the specified</span></span><br><span class="line"><span class="comment">  * number of mappings.  If you supply an initial capacity of 0, the</span></span><br><span class="line"><span class="comment">  * sparse array will be initialized with a light-weight representation</span></span><br><span class="line"><span class="comment">  * not requiring any additional array allocations.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">SparseArrayCompat</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> (initialCapacity == <span class="number">0</span>) &#123;<span class="comment">//如果容量为0，获取两个长度为0的数组</span></span><br><span class="line">         mKeys =  ContainerHelpers.EMPTY_INTS;</span><br><span class="line">         mValues =  ContainerHelpers.EMPTY_OBJECTS;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//创建两个长度相同的数组，一个放key,一个放values</span></span><br><span class="line">         initialCapacity =  ContainerHelpers.idealIntArraySize(initialCapacity);</span><br><span class="line">         mKeys = <span class="keyword">new</span> <span class="keyword">int</span>[initialCapacity];</span><br><span class="line">         mValues = <span class="keyword">new</span> Object[initialCapacity];</span><br><span class="line">     &#125;</span><br><span class="line">     mSize = <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>初始化SparseArray只是简单的创建了两个数组。</p>
<h3 id="put-1"><a href="#put-1" class="headerlink" title="put()"></a>put()</h3><p>接下来就是往SparseArray中存放数据。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, E value)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 首先通过二分查找去 key 数组中查找要插入的 key，返回索引</span></span><br><span class="line">        <span class="keyword">int</span> i =  ContainerHelpers.binarySearch(mKeys, mSize, key);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (i &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="comment">// 如果 i&gt;=0 说明数组中已经有了该key，则直接覆盖原来的值</span></span><br><span class="line">            mValues[i] = value;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">// 取反，这里得到的i应该是最适合该key的插入位置，具体怎么得到的，后面会说</span></span><br><span class="line">            i = ~i;</span><br><span class="line">			<span class="comment">// 如果索引小于当前已经存放的长度，并且这个位置上的值为DELETED(即被标记为删除的值)</span></span><br><span class="line">            <span class="keyword">if</span> (i &lt; mSize &amp;&amp; mValues[i] == DELETED) &#123;</span><br><span class="line">				<span class="comment">// 直接赋值并返回，注意 size 不需要增加</span></span><br><span class="line">                mKeys[i] = key;</span><br><span class="line">                mValues[i] = value;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">			<span class="comment">// 到这一步说明直接赋值失败，检查当前是否被标记待回收且当前存放的长度已经大于或等于了数组长度</span></span><br><span class="line">            <span class="keyword">if</span> (mGarbage &amp;&amp; mSize &gt;= mKeys.length) &#123;</span><br><span class="line">				<span class="comment">// 回收数组中应该被干掉的值</span></span><br><span class="line">                gc();</span><br><span class="line">				<span class="comment">// 重新再获取一下索引，因为数组发生了变化</span></span><br><span class="line">                <span class="comment">// Search again because indices may have changed.</span></span><br><span class="line">                i = ~ ContainerHelpers.binarySearch(mKeys, mSize, key);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//扩容</span></span><br><span class="line">            <span class="keyword">if</span> (mSize &gt;= mKeys.length) &#123;</span><br><span class="line">                <span class="keyword">int</span> n =  ContainerHelpers.idealIntArraySize(mSize + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">int</span>[] nkeys = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">                Object[] nvalues = <span class="keyword">new</span> Object[n];</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Log.e("SparseArray", "grow " + mKeys.length + " to " + n);</span></span><br><span class="line">                System.arraycopy(mKeys, <span class="number">0</span>, nkeys, <span class="number">0</span>, mKeys.length);</span><br><span class="line">                System.arraycopy(mValues, <span class="number">0</span>, nvalues, <span class="number">0</span>, mValues.length);</span><br><span class="line"></span><br><span class="line">                mKeys = nkeys;</span><br><span class="line">                mValues = nvalues;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (mSize - i != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// Log.e("SparseArray", "move " + (mSize - i));</span></span><br><span class="line">                System.arraycopy(mKeys, i, mKeys, i + <span class="number">1</span>, mSize - i);</span><br><span class="line">                System.arraycopy(mValues, i, mValues, i + <span class="number">1</span>, mSize - i);</span><br><span class="line">            &#125;</span><br><span class="line">			<span class="comment">// 最终在 i 位置上插入键与值，并且size ＋1</span></span><br><span class="line">            mKeys[i] = key;</span><br><span class="line">            mValues[i] = value;</span><br><span class="line">            mSize++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>上面这段代码是一次插入数据的操作，单看的话有些难懂，因为插入跟删除之间有一定的关系，所以要看懂这段代码，还必须搞懂删除的逻辑。在看删除之前，还是先大体梳理一下插入的几个特点：</p>
<ul>
<li>存放key的数组是有序的（二分查找的前提条件）</li>
<li>如果冲突，新值直接覆盖原值，并且不会返回原值（HashMap会返回原值）</li>
<li>如果当前要插入的 key 的索引上的值为DELETE，直接覆盖</li>
<li>前几步都失败了，检查是否需要gc()并且在该索引上插入数据</li>
</ul>
<p>插入的逻辑大体上是这四点，理解起来可能还是有些抽象，我们来几张图：</p>
<h3 id="冲突直接覆盖"><a href="#冲突直接覆盖" class="headerlink" title="冲突直接覆盖"></a>冲突直接覆盖</h3><p><img src="/2018/09/19/SparseArray的使用及实现原理/sparse_array_put_one.jpg" alt="冲突直接覆盖"><br>冲突直接覆盖原值</p>
<p>上面这个图，插入一个key=3的元素，因为在mKeys中已经存在了这个值，则直接覆盖。</p>
<h3 id="插入索引上为DELETED"><a href="#插入索引上为DELETED" class="headerlink" title="插入索引上为DELETED"></a>插入索引上为DELETED</h3><p><img src="/2018/09/19/SparseArray的使用及实现原理/sparse_array_put_two.jpg" alt="索引上为DELETED"></p>
<p>注意mKeys中并没有 3 这个值，但是通过二分查找得出来，目前应该插入的索引位置为 2 ，即key=4所在的位置，而当前这个位置上对应的value标记为DELETED了，所以会直接将该位置上的key赋值为 3 ，并且将该位置上的value赋值为put()传入的对象。</p>
<h3 id="索引上有值，但是应该触发gc"><a href="#索引上有值，但是应该触发gc" class="headerlink" title="索引上有值，但是应该触发gc()"></a>索引上有值，但是应该触发gc()</h3><p><img src="/2018/09/19/SparseArray的使用及实现原理/sparse_array_put_three.jpg" alt="索引上有值，但是应该触发gc"><br>触发gc()</p>
<p>注意这个图跟前面的几个又一个区别，那就是数组已经满容量了，而且 3 应该插入的位置已经有 4 了，而 5 所指向的值为DELETED，这种情况下，会先去回收DELETED,重新调整数组结构，图中的例子则会回收 5 ,然后再重新计算 3 应该插入的位置</p>
<h3 id="满容且无法gc"><a href="#满容且无法gc" class="headerlink" title="满容且无法gc()"></a>满容且无法gc()</h3><p><img src="/2018/09/19/SparseArray的使用及实现原理/sparse_array_put_four.jpg" alt="满容且无法gc"><br>满容且无法触发gc()</p>
<p>这种情况下，就只能对数组进行扩容，然后插入数据。</p>
<p>结合这几个图，插入的流程应该很清晰了，但是put()还有几个值得我们探索的点，首先就是二分查找的算法，这是一个很普通的二分算法，注意最后一行代码，当找不到这个值的时候return ~lo，实际上到这一步的时候，理论上lo==mid==hi。所以这个位置是最适合插入数据的地方。但是为了让能让调用者既知道没有查到值，又知道索引位置，做了一个取反操作，返回一个负数。这样调用处可以首先通过正负来判断命中，之后又可以通过取反获取索引位置。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This is Arrays.binarySearch(), but doesn't do any argument validation.</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">binarySearch</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> size, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> lo = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> hi = size - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (lo &lt;= hi) &#123;</span><br><span class="line">            <span class="keyword">int</span> mid = (lo + hi) &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">int</span> midVal = array[mid];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (midVal &lt; value) &#123;</span><br><span class="line">                lo = mid + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (midVal &gt; value) &#123;</span><br><span class="line">                hi = mid - <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> mid;  <span class="comment">// value found</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ~lo;  <span class="comment">// value not present</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>第二个点就是，插入数据具体是怎么插入的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mKeys = GrowingArrayUtils.insert(mKeys, mSize, i, key);</span><br><span class="line">mValues = GrowingArrayUtils.insert(mValues, mSize, i, value);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Primitive int version of &#123;<span class="doctag">@link</span> #insert(Object[], int, int, Object)&#125;.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] insert(<span class="keyword">int</span>[] array, <span class="keyword">int</span> currentSize, <span class="keyword">int</span> index, <span class="keyword">int</span> element) &#123;</span><br><span class="line">       <span class="keyword">assert</span> currentSize &lt;= array.length;</span><br><span class="line">	<span class="comment">// 如果当前的长度加1还是小于数组长度</span></span><br><span class="line">       <span class="keyword">if</span> (currentSize + <span class="number">1</span> &lt;= array.length) &#123;</span><br><span class="line">		<span class="comment">// 复制数组,没有进行扩容</span></span><br><span class="line">           System.arraycopy(array, index, array, index + <span class="number">1</span>, currentSize - index);</span><br><span class="line">           array[index] = element;</span><br><span class="line">           <span class="keyword">return</span> array;</span><br><span class="line">       &#125;</span><br><span class="line">	<span class="comment">// 需要扩容，分为两步，首先复制前半部分</span></span><br><span class="line">       <span class="keyword">int</span>[] newArray = <span class="keyword">new</span> <span class="keyword">int</span>[growSize(currentSize)];</span><br><span class="line">       System.arraycopy(array, <span class="number">0</span>, newArray, <span class="number">0</span>, index);</span><br><span class="line">	<span class="comment">// 插入数据</span></span><br><span class="line">       newArray[index] = element;</span><br><span class="line">	<span class="comment">// 复制后半部分</span></span><br><span class="line">       System.arraycopy(array, index, newArray, index + <span class="number">1</span>, array.length - index);</span><br><span class="line">       <span class="keyword">return</span> newArray;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>put()部分的代码就全部完毕了，接下来先来看看remove()是怎么处理的？</p>
<h3 id="remove-1"><a href="#remove-1" class="headerlink" title="remove()"></a>remove()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Removes the mapping from the specified key, if there was any.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 找到该 key 的索引</span></span><br><span class="line">        <span class="keyword">int</span> i =  ContainerHelpers.binarySearch(mKeys, mSize, key);</span><br><span class="line">		<span class="comment">// 如果存在，将该索引上的 value 赋值为 DELETED</span></span><br><span class="line">        <span class="keyword">if</span> (i &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mValues[i] != DELETED) &#123;</span><br><span class="line">                mValues[i] = DELETED;</span><br><span class="line">				<span class="comment">// 标记当前状态为待回收</span></span><br><span class="line">                mGarbage = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Alias for &#123;<span class="doctag">@link</span> #delete(int)&#125;.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        delete(key);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>事实上，SparseArray在进行remove()操作的时候分为两个步骤：</p>
<ul>
<li>删除value — 在remove()中处理</li>
<li>删除key — 在gc()中处理，注意这里不是系统的 GC，只是SparseArray 的一个方法</li>
</ul>
<p>remove()中，将这个key指向了DELETED，这时候value失去了引用，如果没有其它的引用，会在下一次系统内存回收的时候被干掉。来看一张图：<br><img src="/2018/09/19/SparseArray的使用及实现原理/sparse_array_remove.png" alt="remove"></p>
<p>但是可以看到key仍然保存在数组中，并没有马上删除，目的应该是为了保持索引结构，同时不会频繁压缩数组，保证索引查询不会错位，那么key什么时候被删除呢？当SparseArray的gc()被调用时。</p>
<blockquote>
<p>To help with performance, the container includes an optimization when removing keys: instead of compacting its array immediately, it leaves the removed entry marked as deleted. The entry can then be re-used for the same key, or compacted later in a single garbage collection step of all removed entries. This garbage collection will need to be performed at any time the array needs to be grown or the the map size or entry values are retrieved.</p>
</blockquote>
<h3 id="gc"><a href="#gc" class="headerlink" title="gc()"></a>gc()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Log.e("SparseArray", "gc start with " + mSize);</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> n = mSize;</span><br><span class="line">        <span class="keyword">int</span> o = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span>[] keys = mKeys;</span><br><span class="line">        Object[] values = mValues;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            Object val = values[i];</span><br><span class="line">			<span class="comment">// 当前这个 value 不等于 DELETED</span></span><br><span class="line">            <span class="keyword">if</span> (val != DELETED) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i != o) &#123;</span><br><span class="line">					<span class="comment">// i != o</span></span><br><span class="line">					<span class="comment">// 将索引 i 处的 key 赋值给 o 处的key</span></span><br><span class="line">                    keys[o] = keys[i];</span><br><span class="line">					<span class="comment">// 同时将值也赋值给 o 处</span></span><br><span class="line">                    values[o] = val;</span><br><span class="line">					<span class="comment">// 最后将 i 处的值置为空</span></span><br><span class="line">                    values[i] = <span class="keyword">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">				<span class="comment">// o 向后移动一位</span></span><br><span class="line">                o++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        mGarbage = <span class="keyword">false</span>;</span><br><span class="line">        mSize = o;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Log.e("SparseArray", "gc end with " + mSize);</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>上面的这段代码，直接看可能理解起来也比较困难，主要是理解 o 只有在值等于DELETED的时候才不会向后移，也就是说，当i向后移动一位的时候，o还在值为DELETED的地方，而这时候因为i != o，就会触发第二个判断条件，将i位置的元素向前移动到o处。来看一张图：<br><img src="/2018/09/19/SparseArray的使用及实现原理/sparse_array_gc.png" alt="GC"><br>如上图所示，在 3 之前，i与o都是相等的，而到 3 的时候，因为值为DELETED，所以只有i++，而o的值仍然等于 2，重点来了，到 4 的时候，发现i!=o,则会将 4 向前移动到 3，这时候o++了，但是因为o始终小于i一位（这个例子里面），因此后面的元素均会向前移动一位。</p>
<p>gc()的原理了解了，那么在什么情况下会触发gc()呢？上面已经知道在添加元素的时候可能会触发gc()，除了添加元素，前文提到过一系列跟index有关的方法，事实上在调用这些方法的时候，都会试图去触发gc()，这样可以返回给调用者一个精确的索引值。</p>
<h3 id="get-1"><a href="#get-1" class="headerlink" title="get()"></a>get()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> key, E valueIfKeyNotFound)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i =  ContainerHelpers.binarySearch(mKeys, mSize, key);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || mValues[i] == DELETED) &#123;</span><br><span class="line">            <span class="keyword">return</span> valueIfKeyNotFound;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (E) mValues[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>get()中的代码就比较简单了，通过二分查找获取到key的索引，通过该索引来获取到value</p>
<h2 id="SparseArray-的系列"><a href="#SparseArray-的系列" class="headerlink" title="SparseArray 的系列"></a>SparseArray 的系列</h2><p>除了前面分析的SparseArray，其实还有其它的一些类似的数据结构，它们总结起来就是用于存放基本数据类型的键值对：</p>
<ul>
<li>SparseIntArray — int:int</li>
<li>SparseBooleanArray— int:boolean</li>
<li>SparseLongArray— int:long</li>
</ul>
<p>就不一一列举了，有兴趣的可以一个一个去看看，实现原理都差不太多。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>了解了SparseArray的实现原理，就该来总结一下它与HashMap之间来比较的优缺点</p>
<p>优势：</p>
<ul>
<li>避免了基本数据类型的装箱操作</li>
<li>不需要额外的结构体，单个元素的存储成本更低</li>
<li>数据量小的情况下，随机访问的效率更高</li>
</ul>
<p>有优点就一定有缺点</p>
<ul>
<li>插入操作需要复制数组，增删效率降低</li>
<li>数据量巨大时，复制数组成本巨大，gc()成本也巨大</li>
<li>数据量巨大时，查询效率也会明显下降</li>
</ul>
<p>学习完了SparseArray，相信你对这个系列的数据结构有了更深的认识，什么时候选择什么样的数据结构，在一定程度上对于程序的运行效率会有那么一些帮助。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https//xlee00.github.io/2018/09/19/SparseArray的使用及实现原理/" data-id="ckdfp0b500012iwn5wq49btid" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SparseArray/">SparseArray</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/09/20/monkey命令详解/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          monkey命令详解
        
      </div>
    </a>
  
  
    <a href="/2018/09/19/SparseArray与SparseArrayCompat区别/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">SparseArray与SparseArrayCompat区别</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/人文/">人文</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/人文/人文其它/">人文其它</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂谈/">杂谈</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/科技/">科技</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/科技/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/科技/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/科技/Others/">Others</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/科技/Raspberry/">Raspberry</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/科技/Ubuntu/">Ubuntu</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/科技/Wordpress/">Wordpress</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/科技/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/科技/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/科技/svn/">svn</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/7z/" style="font-size: 10px;">7z</a> <a href="/tags/Android-TV/" style="font-size: 10px;">Android TV</a> <a href="/tags/Fragment/" style="font-size: 10px;">Fragment</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/Google-Play/" style="font-size: 10px;">Google Play</a> <a href="/tags/Google-billing/" style="font-size: 10px;">Google billing</a> <a href="/tags/Google-payment/" style="font-size: 10px;">Google payment</a> <a href="/tags/Gz/" style="font-size: 10px;">Gz</a> <a href="/tags/Hexo/" style="font-size: 11.67px;">Hexo</a> <a href="/tags/IP/" style="font-size: 10px;">IP</a> <a href="/tags/LNMP/" style="font-size: 10px;">LNMP</a> <a href="/tags/Launcher/" style="font-size: 11.67px;">Launcher</a> <a href="/tags/OpenVPN/" style="font-size: 10px;">OpenVPN</a> <a href="/tags/Rar/" style="font-size: 10px;">Rar</a> <a href="/tags/Raspberry/" style="font-size: 13.33px;">Raspberry</a> <a href="/tags/RecyclerView/" style="font-size: 10px;">RecyclerView</a> <a href="/tags/SSH/" style="font-size: 10px;">SSH</a> <a href="/tags/ScrollBar/" style="font-size: 10px;">ScrollBar</a> <a href="/tags/Scrollbar/" style="font-size: 10px;">Scrollbar</a> <a href="/tags/SparseArray/" style="font-size: 11.67px;">SparseArray</a> <a href="/tags/SparseArrayCompat/" style="font-size: 10px;">SparseArrayCompat</a> <a href="/tags/Supervisor/" style="font-size: 10px;">Supervisor</a> <a href="/tags/Tar/" style="font-size: 10px;">Tar</a> <a href="/tags/Tar-gz/" style="font-size: 10px;">Tar.gz</a> <a href="/tags/Ubuntu/" style="font-size: 18.33px;">Ubuntu</a> <a href="/tags/Unrar/" style="font-size: 10px;">Unrar</a> <a href="/tags/Vim/" style="font-size: 10px;">Vim</a> <a href="/tags/WIFI/" style="font-size: 10px;">WIFI</a> <a href="/tags/WPS/" style="font-size: 10px;">WPS</a> <a href="/tags/War/" style="font-size: 10px;">War</a> <a href="/tags/Wordpress/" style="font-size: 10px;">Wordpress</a> <a href="/tags/Xz/" style="font-size: 10px;">Xz</a> <a href="/tags/YAML/" style="font-size: 10px;">YAML</a> <a href="/tags/Zip/" style="font-size: 10px;">Zip</a> <a href="/tags/aar/" style="font-size: 10px;">aar</a> <a href="/tags/adb/" style="font-size: 10px;">adb</a> <a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/apk/" style="font-size: 10px;">apk</a> <a href="/tags/apply/" style="font-size: 10px;">apply</a> <a href="/tags/bash/" style="font-size: 10px;">bash</a> <a href="/tags/bat/" style="font-size: 10px;">bat</a> <a href="/tags/billing-test/" style="font-size: 10px;">billing test</a> <a href="/tags/bz2/" style="font-size: 10px;">bz2</a> <a href="/tags/centos/" style="font-size: 10px;">centos</a> <a href="/tags/cpu/" style="font-size: 10px;">cpu</a> <a href="/tags/drawable/" style="font-size: 10px;">drawable</a> <a href="/tags/eclipse/" style="font-size: 10px;">eclipse</a> <a href="/tags/egrep/" style="font-size: 10px;">egrep</a> <a href="/tags/emmc/" style="font-size: 10px;">emmc</a> <a href="/tags/fgrep/" style="font-size: 10px;">fgrep</a> <a href="/tags/git/" style="font-size: 20px;">git</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/gitignore/" style="font-size: 10px;">gitignore</a> <a href="/tags/gradle/" style="font-size: 10px;">gradle</a> <a href="/tags/grep/" style="font-size: 10px;">grep</a> <a href="/tags/hardware/" style="font-size: 10px;">hardware</a> <a href="/tags/import/" style="font-size: 10px;">import</a> <a href="/tags/keystore/" style="font-size: 10px;">keystore</a> <a href="/tags/monkey/" style="font-size: 10px;">monkey</a> <a href="/tags/no-permission/" style="font-size: 10px;">no_permission</a> <a href="/tags/notifyItemChanged/" style="font-size: 10px;">notifyItemChanged</a> <a href="/tags/response/" style="font-size: 10px;">response</a> <a href="/tags/screenshot/" style="font-size: 10px;">screenshot</a> <a href="/tags/sspanel/" style="font-size: 10px;">sspanel</a> <a href="/tags/state/" style="font-size: 10px;">state</a> <a href="/tags/supervisor/" style="font-size: 10px;">supervisor</a> <a href="/tags/svn/" style="font-size: 11.67px;">svn</a> <a href="/tags/unpacker-error/" style="font-size: 10px;">unpacker error</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/win10/" style="font-size: 11.67px;">win10</a> <a href="/tags/不对称/" style="font-size: 10px;">不对称</a> <a href="/tags/乱码/" style="font-size: 11.67px;">乱码</a> <a href="/tags/代码仓库/" style="font-size: 10px;">代码仓库</a> <a href="/tags/位置/" style="font-size: 10px;">位置</a> <a href="/tags/信息/" style="font-size: 10px;">信息</a> <a href="/tags/修改文件名/" style="font-size: 10px;">修改文件名</a> <a href="/tags/出栈/" style="font-size: 10px;">出栈</a> <a href="/tags/制作/" style="font-size: 10px;">制作</a> <a href="/tags/加密/" style="font-size: 11.67px;">加密</a> <a href="/tags/博客/" style="font-size: 16.67px;">博客</a> <a href="/tags/原理/" style="font-size: 11.67px;">原理</a> <a href="/tags/后台/" style="font-size: 10px;">后台</a> <a href="/tags/启动方式/" style="font-size: 10px;">启动方式</a> <a href="/tags/命令/" style="font-size: 10px;">命令</a> <a href="/tags/回退/" style="font-size: 10px;">回退</a> <a href="/tags/多个图标/" style="font-size: 10px;">多个图标</a> <a href="/tags/大小写/" style="font-size: 10px;">大小写</a> <a href="/tags/字体/" style="font-size: 10px;">字体</a> <a href="/tags/字符编码/" style="font-size: 10px;">字符编码</a> <a href="/tags/客户端/" style="font-size: 10px;">客户端</a> <a href="/tags/对称/" style="font-size: 10px;">对称</a> <a href="/tags/库/" style="font-size: 10px;">库</a> <a href="/tags/快捷方式/" style="font-size: 10px;">快捷方式</a> <a href="/tags/快捷键/" style="font-size: 10px;">快捷键</a> <a href="/tags/截屏/" style="font-size: 10px;">截屏</a> <a href="/tags/批量/" style="font-size: 10px;">批量</a> <a href="/tags/显示隐藏/" style="font-size: 10px;">显示隐藏</a> <a href="/tags/更改icon/" style="font-size: 10px;">更改icon</a> <a href="/tags/杂谈/" style="font-size: 10px;">杂谈</a> <a href="/tags/权限/" style="font-size: 10px;">权限</a> <a href="/tags/模版/" style="font-size: 10px;">模版</a> <a href="/tags/注释头/" style="font-size: 10px;">注释头</a> <a href="/tags/测试/" style="font-size: 10px;">测试</a> <a href="/tags/滚动条/" style="font-size: 10px;">滚动条</a> <a href="/tags/白名单/" style="font-size: 10px;">白名单</a> <a href="/tags/监听/" style="font-size: 10px;">监听</a> <a href="/tags/科学上网/" style="font-size: 10px;">科学上网</a> <a href="/tags/签名/" style="font-size: 11.67px;">签名</a> <a href="/tags/系统开发/" style="font-size: 10px;">系统开发</a> <a href="/tags/编码转换/" style="font-size: 10px;">编码转换</a> <a href="/tags/自定义/" style="font-size: 10px;">自定义</a> <a href="/tags/软键盘/" style="font-size: 10px;">软键盘</a> <a href="/tags/过滤/" style="font-size: 10px;">过滤</a> <a href="/tags/运营商定制/" style="font-size: 10px;">运营商定制</a> <a href="/tags/运行慢/" style="font-size: 11.67px;">运行慢</a> <a href="/tags/门字不正确/" style="font-size: 10px;">门字不正确</a> <a href="/tags/非对称/" style="font-size: 10px;">非对称</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">九月 2014</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/08/04/Android解决依赖冲突：Program-type-already-present/">Android解决依赖冲突：Program type already present</a>
          </li>
        
          <li>
            <a href="/2020/07/31/为什么换主芯片，同时要换EMMC？/">为什么换主芯片，同时要换EMMC？</a>
          </li>
        
          <li>
            <a href="/2020/06/15/Git命令你需要知道的坑/">Git命令你需要知道的坑</a>
          </li>
        
          <li>
            <a href="/2020/04/26/常用指令/">常用指令</a>
          </li>
        
          <li>
            <a href="/2020/04/16/android如何判断两个APK签名是否一样/">android如何判断两个APK签名是否一样</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Xlee<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>